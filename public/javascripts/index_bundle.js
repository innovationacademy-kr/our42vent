(()=>{"use strict";Sentry.init({dsn:"https://93f50a72783642f2bb01edfc10a44e9f@o1134287.ingest.sentry.io/6181589"}),function(){const e=document.querySelector(".user-username");e.textContent.length>7&&(e.style.fontSize=".87em")}();const e=document.querySelector(".user-drop-button"),t=document.querySelector(".user-drop-content"),n=t.firstElementChild.nextElementSibling.firstElementChild;e.addEventListener("click",(()=>{t.classList.contains("hidden")?e.firstElementChild.style.color="var(--light_mint)":t.classList.contains("hidden")||(e.firstElementChild.style.color="var(--white)"),t.classList.toggle("hidden")})),n.addEventListener("click",(()=>sessionStorage.clear())),document.body.addEventListener("click",(n=>{e.contains(n.target)||t.contains(n.target)||t.classList.contains("hidden")||(t.classList.toggle("hidden"),e.firstElementChild.style.color="var(--white)")})),document.querySelector(".user-imageurl").addEventListener("error",(e=>{e.target.src="/assets/images/user_default.png",e.onerror=null}));const o=document.querySelector(".toggle-icon"),i=document.querySelector("nav"),s=document.querySelector("main");function a(e,t){const n=new Date(new Date(e).setSeconds(0,0)),o=new Date(t),i=(new Date(o.getFullYear(),o.getMonth(),o.getDate(),n.getHours(),n.getMinutes())-n)/864e5;let s;return s=i>1?`for ${i+1} days`:1===i?"for 2 days":function(e,t){let n,o;const i=(t-e)/6e4,s=Math.floor(i/60);n=s>1?`${s} hours`:1===s?"1 hour":"";const a=i-60*s;return o=a>1?`${a} mins`:1===a?"1 min":"",`for ${n} ${o}`}(n,o),{duration:s,diffInDays:i}}function r(e,t,n){const o=["일","월","화","수","목","금","토"],i=new Date(e),s=new Date(t),[a,r,c,l,d,u]=[i.getFullYear(),i.getMonth()+1,i.getDate(),o[i.getDay()],i.getHours(),i.getMinutes()],[y,m,g,v,f,h]=[s.getFullYear(),s.getMonth()+1,s.getDate(),o[s.getDay()],s.getHours(),s.getMinutes()],p=d>9?d:`0${d}`,b=u>9?u:`0${u}`,w=f>9?f:`0${f}`,S=h>9?h:`0${h}`;return n>=1?`${a}년 ${r}월 ${c}일 (${l}) ${p}:${b} ~ ${y}년 ${m}월 ${g}일 (${v}) ${w}:${S}`:`${a}년 ${r}월 ${c}일 (${l}) ${p}:${b} ~ ${w}:${S}`}function c(e){const{id:t,title:n,personInCharge:o,beginAt:i,endAt:s,location:c,topic:l,details:d}=e,{diffInDays:u}=a(i,s);let y=`${n}\n\n주제: ${l}\n일시: ${r(i,s,u)}\n장소: ${c}`;o&&(y+=`\n발표자/담당자: ${o}`),d&&(y+=`\n\n${d}`);const m=`우리42벤트에서 확인하기 -> ${window.location.origin}/event/info/${t}`;document.querySelector(".layout-promotion").style.display="grid";const g=document.querySelector(".promotion-text");g.textContent=y,document.querySelector(".promotion-url-text").textContent=m,function(e){const t=e;t.style.height="1px",t.style.height=`${t.scrollHeight}px`}(g)}o.addEventListener("click",(()=>{o.classList.toggle("change"),i.classList.toggle("change")})),s.addEventListener("click",(()=>{"change".localeCompare(i.classList[0])||(o.classList.toggle("change"),i.classList.toggle("change"))})),function(){const e=document.querySelectorAll(".navbar-category input[type=checkbox]");let t=[];sessionStorage.getItem("categories")?(t=sessionStorage.getItem("categories").split("-"),e.forEach((e=>{const n=e;t.includes(n.name)&&(n.checked=!0)}))):(e.forEach((e=>{const n=e;t.push(n.name),n.checked=!0})),sessionStorage.setItem("categories",`-${t.join("-")}`)),e.forEach((e=>{const t=e,{checked:n,name:o}=t,i=t.parentElement.querySelector(`.${o}.box-wrapper > i`);n||(i.textContent="")}))}();const l=axios.create({timeout:1e4});l.interceptors.response.use((e=>e.data),(e=>("ECONNABORTED"===e?.code&&window.location.replace("/error/408"),404===e?.response?.status&&window.location.replace("/error/404"),401===e?.response?.status&&window.location.replace("/logout"),Promise.reject(e))));const d=l;function u(e){const t=/https?:\/\//;let n;return e.replace(/(https?:\/\/(www\.)?)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-z]{2,4}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g,(e=>(n=t.test(e)?"":"42seoul.io/cluster"===e?"http://":"https://",`<a class="details-anchor" href="${n+e}">${e}</a>`)))}const y=Swal.mixin({confirmButtonColor:"#58b7ba",showConfirmButton:!0,showCancelButton:!1}),m=Swal.mixin({showCancelButton:!0,confirmButtonColor:"#58b7ba",cancelButtonColor:"#d33",confirmButtonText:"예",cancelButtonText:"아니요"});async function g(e){const t=await async function(e){return await d.get(`/event/${e}`).catch((e=>{y.fire({title:"오류가 발생하였습니다.",icon:"error"}).then((()=>{throw e}))}))}(e),{title:n,personInCharge:o,beginAt:i,endAt:s,location:l,category:m,topic:g,details:v,isMyEvent:f,notification:h}=t;document.querySelector(".details-category").textContent=function(e){let t;switch(e){case"lecture":t="특강";break;case"exam":t="시험";break;case"contest":t="해커톤/공모전";break;case"conference":t="세미나/컨퍼런스";break;default:t="커뮤니티"}return t}(m),document.querySelector(".details-title").textContent=n;const{duration:p,diffInDays:b}=a(i,s);document.querySelector(".details-range").textContent=r(i,s,b),document.querySelector(".details-duration").innerHTML=`<i class="material-icons"> schedule</i>&nbsp;&nbsp;${p}`,document.querySelector(".details-location").innerHTML=`<i class="material-icons">room</i>&nbsp;${u(l)}`,function(e,t,n){const o=document.querySelector(".details-pic");""!==e&&null!==e?(o.innerHTML=`<span class="details-pic-label text-bold">발표자 / 담당자&nbsp;&nbsp;:</span>&nbsp;&nbsp;${e}`,o.style.display="flex"):(o.innerHTML="",o.style.display="none"),document.querySelector(".details-topic").innerHTML=`<div class="details-topic-label text-bold">주제</div><div class="details-topic-content">${t}</div>`;const i=document.querySelector(".details-details");""!==n&&null!==n?(i.innerHTML=`<div class="details-details-label text-bold">상세정보</div><div class="details-details-content">${u(n)}</div>`,i.style.display="flex"):(i.innerHTML="",i.style.display="none")}(o,g,v),function(e,t,n,o){const[i,s,a]=[new Date,new Date(e),new Date(t)],r=document.querySelector(".notification-button");if(i>a)return document.querySelectorAll(".notification-button > *").forEach((e=>{e.style.display="none"})),void(r.style.height="0px");r.style.height="",r.style.flexDirection="";const c=n?[".details-myevent-button",".details-cancel-button"]:[".details-cancel-button",".details-myevent-button"];if(document.querySelector(c[0]).style.display="none",document.querySelector(c[1]).style.display="block","serviceWorker"in navigator&&"PushManager"in window&&i<s){const e=document.querySelector(".details-notification-info");let t=[".details-notification-info","#details-notification"];n&&(t=["#details-notification",".details-notification-info"],e.textContent=i>s||null===o?"":0===o?"이벤트 시작 시간 알림":`이벤트 ${o}분 전 알림`),document.querySelector(t[0]).style.display="none",document.querySelector(t[1]).style.display="block"}else document.querySelector("#details-notification").style.display="none",document.querySelector(".details-notification-info").style.display="none",r.style.flexDirection="row-reverse"}(i,s,f,h),function(e,t){const n=document.querySelector(".details-exit-button"),o=document.querySelector(".details-share-button");n.addEventListener("click",(()=>{document.querySelector(".layout-details").style.display="none"})),o.addEventListener("click",(()=>{const n=e;n.id=t,n.beginAt=new Date(n.beginAt).toISOString(),n.endAt=new Date(n.endAt).toISOString(),c(n)}))}(t,e),document.getElementById("details-notification").value="none"}function v(e,t=[],n=null){const o=document.createElement(e);return t.forEach((e=>{e&&o.classList.add(e)})),n&&(o.textContent=n),o}function f(e){e.forEach((e=>e.remove()))}function h(e){document.querySelectorAll(".month-more-button").forEach((e=>{const t=e.parentElement.querySelector(".month-more");e.addEventListener("click",(()=>{t.style.display="grid"})),document.addEventListener("click",(n=>{n.target===e||t.contains(n.target)||(t.style.display="none")}))})),document.querySelectorAll(".month-label-multi, .month-label-end").forEach((e=>{document.querySelectorAll(`.${e.classList[0]}`).forEach((t=>{const n=t;e.addEventListener("pointerenter",(e=>{"touch"!==e.pointerType&&(n.style.boxShadow="1px 1px 1px var(--dark_grey)")})),e.addEventListener("pointerleave",(e=>{"touch"!==e.pointerType&&(n.style.boxShadow="none")}))}))})),function(e){document.querySelectorAll(".month-label-single, .month-label-multi, .month-label-end").forEach((t=>{t.addEventListener("pointermove",(n=>{if("touch"===n.pointerType)return;const o=document.querySelector(".beginat-svg");o&&o.remove();const{beginAt:i,isMulti:s}=e.find((e=>e.id===Number(t.classList[0].substring(9)))),a=new Date(new Date(i).getTime()+324e5).toISOString(),r=document.body.appendChild(v("div",["beginat-svg"])),c=s?`${a.slice(5,7)}/${a.slice(8,10)} ${a.slice(11,16)}`:a.slice(11,16),l=s?68:40;r.innerHTML=`<svg width="${l}" height="23" viewBox="0 0 ${l} 23" fill="none"xmlns="http://www.w3.org/2000/svg"><rect x="${l}" y="22.0771" width="${l}" height="22"rx="3" transform="rotate(-180 ${l} 22.0771)" fill="black" fill-opacity="0.7"/><text x="8"y="14" fill="#fff" width="${l}" height="26" font-family="'Noto Sans KR', sans-serif" font-size="11">${c}</text></svg>`,r.style.left=""+(n.clientX-l+2),r.style.top=`${n.clientY+12+window.scrollY}`})),t.addEventListener("pointerleave",(e=>{if("touch"===e.pointerType)return;const t=document.querySelector(".beginat-svg");t&&t.remove()}))}))}(e),async function(){document.querySelectorAll("[class^=_eventId-]").forEach((e=>{const t=e.classList[0].substring(9),n=document.querySelector(".layout-details");e.addEventListener("click",(async()=>{await g(t),[n.id]=e.classList,n.style.display="grid"}))}))}()}function p(e,t,n){const{category:o,id:i,isMulti:s,length:a,title:r}=e;if(-1===a?t.appendChild(v("div",["month-label-empty"])):s?t.appendChild(S(i,o,r)):w(t,i,o,r),a>1){const e=document.querySelector(".calendar-month").offsetWidth/7,s=t.appendChild(v("div",[`_eventId-${i}`,"month-label-multi","xsmall",o],r));s.style.width=""+(2*(e-5)+e*(a-2)-1),s.style.top=""+(20+24*n)}}function b(e){const{date:t,dateIndex:n,eventArray:o,moreEventDiv:i,isHoliday:s,noDays:a}=e;a-n-1<=7&&(i.style.bottom=0),n%7==6&&(i.style.right=0);const r=s?"sunday":null;i.appendChild(v("div",["month-more-date","large","text-center",r],t));const c=i.appendChild(v("div",["month-more-event"]));o.forEach((e=>{const{category:t,id:n,isMulti:o,length:i,title:s}=e;-1===i||o?c.appendChild(S(n,t,s)):w(c,n,t,s)}))}function w(e,t,n,o){e.appendChild(v("div",[`_eventId-${t}`,"month-label-single","xsmall",n])).innerHTML=`<span class=single-category></span>${o}`}function S(e,t,n){return v("div",[`_eventId-${e}`,"month-label-end","xsmall",t],n)}function x(e){const t=Object.keys(e).map((e=>Number(e)));let n=0;for(;t.includes(n);)n+=1;return n}function E(e,t,n){const o=document.querySelectorAll(".month-date"),i={};o.forEach(((o,s)=>{!function(e,t,n,o){const{date:i,month:s}=t,a=t.isHoliday?"sunday":null,r=i!==o.getDate()||s!==o.getMonth()||n!==o.getFullYear()?"":"today-circle";e.appendChild(v("div",["month-date-day","small",a])).innerHTML=`<span class="month-day-circle ${r} text-center">${i}</span>`}(o,e[s],n,new Date);const a=o.appendChild(v("div",["month-date-events","select-none"]));(function(e,t,n,o){const i=document.querySelector(".month-date").offsetHeight-20,s=e[t].eventArray,a=e[t].slot,r=n;s.forEach(((s,c)=>{const l=s,{id:d,beginAt:u,endAt:y}=l;d in n||(r[`${d}`]=function(e,t,n){const[o,i]=[new Date(e).setHours(0,0,0,0),new Date(t).setHours(0,0,0,0)],s=n>new Date(e).getTime()?(i-n)/864e5+1:(i-o)/864e5+1;return{remainingDays:s,isMulti:s>1,isNextRow:!1}}(u,y,o)),l.isMulti=r[`${d}`].isMulti,l.length=function(e,t,n,o,i){const s=o,a=x(t);let r=s.remainingDays>=1?1:-1;return!Object.values(t).includes(i)&&e-24*(a+1)<22?s.remainingDays-=1:s.remainingDays>1&&(r=-1,n%7||(s.isNextRow=!1),s.isNextRow||(s.remainingDays<=7-n%7?(r=s.remainingDays,s.remainingDays=-1):(r=7-n%7,s.remainingDays-=r,s.isNextRow=!0))),r}(i,a,t,r[`${d}`],c),Object.values(a).includes(c)||function(e,t,n,o){const i=e,{id:s,length:a}=n,r=i[t].slot;if(a>1){const e=x(i[t].slot);for(let n=0;n<a&&t+n<i.length;n+=1){const{eventArray:o}=i[t+n],a=o.findIndex((e=>e.id===s));i[t+n].slot[`${e}`]=a}}else 1===a&&(r[`${x(r)}`]=o)}(e,t,l,c)})),function(e,t){const n=e[t],o=Object.keys(n.slot).map((e=>Number(e))),i=Math.max(...o);let s=0;for(;s+1<i;){for(;o.includes(s);)s+=1;n.slot[`${s}`]=-1,s+=1}}(e,t)})(e,s,i,t),function(e,t,n){const o=e[t],i=document.querySelector(".month-date").offsetHeight-20,{date:s,eventArray:a,slot:r}=o;for(const c in r){const l=r[`${c}`];if(-1===l)n.appendChild(v("div",["month-label-empty"]));else{if(!(i-24*(Number(c)+1)>=22)){n.appendChild(v("button",["month-more-button","xsmall","text-left"],a.length-Number(c)+" more")).type="button",b({date:s,dateIndex:t,eventArray:a,moreEventDiv:n.appendChild(v("div",["month-more"])),isHoliday:o.isHoliday,noDays:e.length});break}p(a[l],n,Number(c))}}}(e,s,a)}))}function $(e,t){const n=JSON.parse(e);return n.forEach((e=>{const n=e;n.eventArray=n.eventArray.filter((e=>t.includes(e.category)))})),n}async function q(){const e=document.querySelector(".calendar-month"),{yearParam:t,monthParam:n}=function(){let e=null,t=null;const n=sessionStorage.getItem("yearMonth");if(n)e=n.slice(0,4),t=n.substring(4);else{const n=new Date;e=n.getFullYear(),t=n.getMonth(),sessionStorage.setItem("yearMonth",`${e}${t}`)}return{yearParam:e,monthParam:t}}(),{dateEventArray:o,noWeeks:i,year:s,monthIndex:a}=await async function(e,t){return sessionStorage.getItem("isMyEvent")?await d.get(`/calendar/myEvent/month/${e}/${t}`).catch((e=>{throw window.location.replace("/error/500"),e})):await d.get(`/calendar/month/${e}/${t}`).catch((e=>{throw window.location.replace("/error/500"),e}))}(t,n),r=sessionStorage.getItem("categories").split("-").slice(1),c=1!==o[0].date?new Date(s,a-1,o[0].date).getTime():new Date(s,a,o[0].date).getTime();f(document.querySelectorAll(".month-date")),function(e,t){const n=document.querySelector(".title-calendar-year");document.querySelector(".title-calendar-month").textContent=`${t+1}월`,n.textContent=e}(s,a),function(e){e.innerHTML='<div class="day-title text-center">일</div><div class="day-title text-center">월</div><div class="day-title text-center">화</div><div class="day-title text-center">수</div><div class="day-title text-center">목</div><div class="day-title text-center">금</div><div class="day-title text-center">토</div>'}(e),function(e,t){const n=t;5===e?n.style.gridTemplate="20px repeat(5, calc(calc(100% - 20px) / 5)) / repeat(7, calc(100% / 7))":6===e?n.style.gridTemplate="20px repeat(6, calc(calc(100% - 20px) / 6)) / repeat(7, calc(100% / 7))":4===e&&(n.style.gridTemplate="20px repeat(4, calc(calc(100% - 20px) / 4)) / repeat(7, calc(100% / 7))");for(let t=0;t<7*e;t+=1){const e=v("div",["month-date"],null);n.appendChild(e)}n.style.borderLeft="var(--calendar_border) solid 1px",n.style.borderTop="var(--calendar_border) solid 1px"}(i,e);const l=$(JSON.stringify(o),r);return E(l,c,s),h(l.flatMap((e=>e.eventArray))),[o,c,s]}const L="/"===window.location.pathname?[q()]:[];function k(){f(document.querySelectorAll(".month-date-day")),f(document.querySelectorAll(".month-date-events")),L[0].then((e=>{const[t,n,o]=e,i=sessionStorage.getItem("categories").split("-").slice(1);t.forEach((e=>{e.slot={}}));const s=$(JSON.stringify(t),i);E(s,n,o),h(s.flatMap((e=>e.eventArray)))}))}document.querySelector(".header-today-button").addEventListener("click",(()=>{const e=new Date,t=`${e.getFullYear()}${e.getMonth()}`;sessionStorage.getItem("yearMonth")!==t&&(sessionStorage.setItem("yearMonth",t),L[0]=q())})),document.querySelector(".title-next").addEventListener("click",(()=>{const e=sessionStorage.getItem("yearMonth");let t=Number(e.slice(0,4)),n=Number(e.substring(4));11===n?(t+=1,n=0):n+=1,sessionStorage.setItem("yearMonth",`${t}${n}`),L[0]=q()})),document.querySelector(".title-prev").addEventListener("click",(()=>{const e=sessionStorage.getItem("yearMonth");let t=Number(e.slice(0,4)),n=Number(e.substring(4));0===n?(t-=1,n=11):n-=1,sessionStorage.setItem("yearMonth",`${t}${n}`),L[0]=q()})),document.querySelectorAll(".navbar-category input[type=checkbox]").forEach(((e,t)=>{const n=e,{name:o}=n,i=n.parentElement.querySelector(`.${o}.box-wrapper > i`);n.addEventListener("change",(()=>{if(n.checked){const e=sessionStorage.getItem("categories");sessionStorage.setItem("categories",`${e}-${o}`),i.textContent="done"}else{const e=sessionStorage.getItem("categories");sessionStorage.setItem("categories",e.replace(`-${o}`,"")),i.textContent=""}k()}))}));const C=document.querySelector(".material-icons-outlined.category-scroll"),I=document.querySelector(".navbar-category");C.addEventListener("click",(()=>{C.classList.toggle("flip-icon")?I.scrollTo({left:I.getBoundingClientRect().right,behavior:"smooth"}):I.scrollTo({left:0,behavior:"smooth"})}));const D=document.querySelector(".navbar-tab-all"),M=document.querySelector(".navbar-tab-my");function T(e){const t=sessionStorage.getItem("isMyEvent")?"우리42벤트 | MY EVENTS":"우리42벤트 | ALL EVENTS";document.title=t,e[0].classList.replace("navbar-tab-inactive","navbar-tab-active"),e[1].classList.replace("navbar-tab-active","navbar-tab-inactive"),e[0].querySelector("svg").classList.replace("navbar-tab-inactive","navbar-tab-active"),e[1].querySelector("svg").classList.replace("navbar-tab-active","navbar-tab-inactive")}D.addEventListener("click",(()=>{sessionStorage.getItem("isMyEvent")&&(sessionStorage.removeItem("isMyEvent"),T([D,M]),L[0]=q())})),M.addEventListener("click",(()=>{sessionStorage.getItem("isMyEvent")||(sessionStorage.setItem("isMyEvent","1"),T([M,D]),L[0]=q())})),T(sessionStorage.getItem("isMyEvent")?[M,D]:[D,M]),window.addEventListener("resize",k),async function(){const e=document.cookie.match(/eventId=\d*/),t=e?e[0].replace("eventId=",""):"";if(document.cookie="eventId= ; expires = Thu, 01 Jan 1970 00:00:00 UTC",""!==t){await g(t);const e=document.querySelector(".layout-details");e.id=`_eventId-${t}`,e.style.display="grid"}}();const A=document.getElementById("details-notification");A.addEventListener("pointermove",(e=>{if("touch"===e.pointerType||!A.disabled)return;const t=document.querySelector(".notification-alert-svg");t&&t.remove();const n=document.body.appendChild(v("div",["notification-alert-svg"]));n.innerHTML='<svg width="130" height="23" viewBox="0 0 130 23" fill="none"xmlns="http://www.w3.org/2000/svg"><rect x="130" y="22.0771" width="130" height="22"rx="3" transform="rotate(-180 130 22.0771)" fill="black" fill-opacity="0.7"/><text x="8"y="14" fill="#fff" width="130" height="26" font-family="\'Noto Sans KR\', sans-serif" font-size="11">알림 설정이 꺼져있습니다</text></svg>',n.style.left=""+(e.clientX-134),n.style.top=`${e.clientY-28+window.scrollY}`})),A.addEventListener("pointerleave",(e=>{if("touch"===e.pointerType||!A.disabled)return;const t=document.querySelector(".notification-alert-svg");t&&t.remove()}));const B=document.querySelector(".details-myevent-button"),N=document.querySelector(".details-cancel-button"),H=document.querySelector(".notification-button");function V(e){const t="subscribe"===e?[B,N]:[N,B];t[0].style.display="none",t[1].style.display="block","/"===window.location.pathname&&sessionStorage.getItem("isMyEvent")&&(L[0]=q());const n=document.querySelector(".details-range").textContent.replace(/[^\d.-]/g," ").split(" ").filter((e=>""!==e)),o=new Date(n[0],n[1]-1,n[2],n[3],n[4]);if("serviceWorker"in navigator&&"PushManager"in window&&new Date<o){const t=document.querySelector(".details-notification-info"),n=document.querySelector("#details-notification"),o="subscribe"===e?[n,t]:[t,n];if("subscribe"===e){const{value:e}=n;t.textContent="none"===e?"":"0"===e?"이벤트 시작 시간 알림":`이벤트 ${e}분 전 알림`}o[0].style.display="none",o[1].style.display="block"}else document.querySelector("#details-notification").style.display="none",document.querySelector(".details-notification-info").style.display="none",H.style.flexDirection="row-reverse"}B.addEventListener("click",(async()=>{const e=document.getElementById("details-notification").value,t=document.querySelector(".layout-details").id.substring(9);d.post(`/event/myevent/${t}`,{notification:e}).then((e=>{y.fire({title:"이벤트가 구독되었습니다.",icon:"success"}).then((()=>V("subscribe")))})).catch((e=>y.fire({title:"오류가 발생하였습니다.",icon:"error"})))})),N.addEventListener("click",(()=>{const e=document.querySelector(".layout-details").id.substring(9);d.delete(`/event/myevent/${e}`).then((e=>{y.fire({title:"구독이 취소되었습니다.",icon:"warning"}).then((()=>V("unsubscribe")))})).catch((e=>y.fire({title:"오류가 발생하였습니다.",icon:"error"})))}));const O=document.getElementById("event-beginat"),Y=document.getElementById("event-endat");function _(e){const t=e.match(/\n/g),n=t?t.length:0;return(new TextEncoder).encode(e).length+n}function F(e){const t=function(e){let t;switch(e){case"event-title":case"event-location":t=224;break;case"event-pic":t=56;break;case"event-topic":t=480;break;default:t=4064}return t}(e),n=document.getElementById(e),o=_(n.value);let i=!0;return"event-pic"!==e&&"event-details"!==e&&""===n.value?(n.setCustomValidity("비어있는 칸을 채워주세요"),i=!1):o>t?(n.setCustomValidity(`이 항목은 ${t}byte를 초과할 수 없습니다. 현재 ${o}bytes 썼습니다.`),i=!1):n.setCustomValidity(""),n.reportValidity(),i}function P(e){const t=document.getElementById(e),n=new Date(t.value),o="event-beginat"===e?"시작":"종료";let i=!0;return""===t.value?(t.setCustomValidity(`${o} 시간을 선택해주세요`),i=!1):n<new Date("1970-01-01T00:00")||n>new Date("4242-12-31T23:59")?(t.setCustomValidity(`${o} 시간은 1970년부터 4242년 사이에서 선택해주세요`),i=!1):t.setCustomValidity(""),t.reportValidity(),i}function R(e){const t=e;t.style.border="none"===t.value?"2px solid red":"2px solid green",t.style.outline="none"}function z(e,t){const n=_(t.value),o=t;let i=!0;switch(e){case"event-title":case"event-location":(!n||n>224)&&(i=!1);break;case"event-pic":n>56&&(i=!1);break;case"event-topic":(!n||n>480)&&(i=!1);break;default:n>4064&&(i=!1)}o.style.border=i?"2px solid green":"2px solid red","event-topic"!==e&&"event-details"!==e||(o.style.outline="none")}function W(e,t){const n=e;""!==n.value&&function(e){const t=new Date("1970-01-01T00:00"),n=new Date("4242-12-31T23:59"),o=new Date(e);return o>=t&&o<=n}(n.value)&&(""===t.value||function(){const e=document.getElementById("event-beginat").value,t=document.getElementById("event-endat").value;return new Date(e)<=new Date(t)}())?n.style.border="2px solid green":n.style.border="2px solid red"}O.addEventListener("click",(function(){""!==Y.value&&(O.max=Y.value)})),Y.addEventListener("click",(function(){""!==O.value&&(Y.min=O.value)})),document.querySelector(".form-button-new").addEventListener("click",(function(){if(F("event-title")&&F("event-pic")&&P("event-beginat")&&P("event-endat")&&function(){const e=document.getElementById("event-beginat"),t=document.getElementById("event-endat");let n=!0;return new Date(e.value)>new Date(t.value)?(t.setCustomValidity("종료시간은 시작시간 이후여야 합니다."),n=!1):t.setCustomValidity(""),t.reportValidity(),n}()&&F("event-location")&&function(){const e=document.getElementById("event-category");let t=!0;return"none"===e.value?(e.setCustomValidity("카테고리를 선택해주세요"),t=!1):e.setCustomValidity(""),e.reportValidity(),t}()&&F("event-topic")&&F("event-details")){const e=document.querySelector(".form"),t=new FormData(e);d.post("/event",t).then((t=>{m.fire({title:"이벤트가 생성되었습니다.",icon:"success",confirmButtonText:"홍보글 생성",cancelButtonText:"닫기"}).then((n=>{n.isConfirmed?(e.reset(),e.parentNode.style.display="none",c(t)):window.location.replace(window.location.pathname)}))})).catch((e=>{y.fire({title:"오류가 발생하였습니다.",icon:"error"})}))}})),document.querySelectorAll(".create-event-button").forEach((e=>{e.addEventListener("click",(()=>{document.querySelector(".layout-form").style.display="grid",document.querySelector(".form-button-new").style.display="block",document.querySelector(".form-button-edit").style.display="none"}))})),document.querySelector(".form-button-exit").addEventListener("click",(()=>{document.querySelector(".layout-form").style.display="none"})),document.querySelector(".promotion-exit-button").addEventListener("click",(()=>{document.querySelector(".layout-promotion").style.display="none"})),document.querySelector(".promotion-copy-button").addEventListener("click",(()=>{const e=document.querySelector(".promotion-text"),t=document.querySelector(".promotion-url-text").textContent,n=e.textContent;e.textContent=`${n}\n\n${t}`,e.select(),document.execCommand("copy"),e.textContent=n,y.fire({title:"복사되었습니다.",icon:"success"})})),["event-title","event-pic","event-location","event-topic","event-details"].forEach((e=>function(e){const t=document.getElementById(e);t.addEventListener("focusin",(()=>{z(e,t),t.addEventListener("keyup",(()=>z(e,t)))})),t.addEventListener("focusout",(()=>{t.style.border="none"}))}(e))),function(){const e=document.getElementById("event-beginat"),t=document.getElementById("event-endat");e.addEventListener("change",(()=>{W(e,t),setTimeout((()=>{e.style.border="none"}),2e3)})),t.addEventListener("change",(()=>{W(t,e),setTimeout((()=>{t.style.border="none"}),2e3)})),e.addEventListener("invalid",(()=>W(e,t))),t.addEventListener("invalid",(()=>W(t,e))),e.addEventListener("blur",(()=>{"2px solid red"===e.style.border&&setTimeout((()=>{e.style.border="none"}),1e3)})),t.addEventListener("blur",(()=>{"2px solid red"===t.style.border&&setTimeout((()=>{t.style.border="none"}),1e3)}))}(),function(){const e=document.getElementById("event-category");e.addEventListener("change",(()=>{R(e),setTimeout((()=>{e.style.border="none"}),2e3)})),e.addEventListener("invalid",(()=>R(e))),e.addEventListener("blur",(()=>{"2px solid red"===e.style.border&&setTimeout((()=>{e.style.border="none"}),1e3)}))}();const j=document.querySelector(".header-today-button");function X(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),o=new Uint8Array(n.length);for(let e=0;e<n.length;e+=1)o[e]=n.charCodeAt(e);return o}async function J(e){return await navigator.serviceWorker.ready,await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:X("BM9QjkyqV9IiwOfuXXIwmq-oteF3ZJQu_vQXyPC-w4FGud6CXxhbFU0SRlCQJfEg9IhDfLXi9x6MzzP4nogUOQE")}),await e.pushManager.getSubscription()}0===navigator.maxTouchPoints&&(j.addEventListener("mousemove",(e=>{const t=document.querySelector(".today-svg");t&&t.remove();const n=new Date,o=document.body.appendChild(v("div",["today-svg"]));o.innerHTML=`<svg width="109" height="23" viewBox="0 0 109 23" fill="none"xmlns="http://www.w3.org/2000/svg"><rect x="109" y="22.0771" width="109" height="22"rx="3" transform="rotate(-180 109 22.0771)" fill="black" fill-opacity="0.7"/><text x="8"y="15" fill="#fff" width="109" height="26" font-family="'Noto Sans KR', sans-serif" font-size="11">오늘, ${n.getFullYear()}년 ${n.getMonth()+1}월  ${n.getDate()}일</text></svg>`,o.style.left=""+(e.clientX-109+2),o.style.top=`${e.clientY+12+window.scrollY}`})),j.addEventListener("mouseleave",(()=>{const e=document.querySelector(".today-svg");e&&e.remove()}))),"serviceWorker"in navigator&&"PushManager"in window?function(){const e=document.querySelectorAll(".notification-switch"),t=document.querySelectorAll(".notification-switch input");!async function(e){const t=await navigator.serviceWorker.getRegistration();if(t){const n=document.querySelector("#details-notification");if(await t.ready,await t.pushManager.getSubscription()){const o=document.cookie.split(";").find((e=>e.includes("pushToken=")));let i=!0;if(!o){const o=await J(t);await d.post("/push",{subscription:o,isFirst:!1}).catch((t=>{if(403===t.response.status){e.forEach((e=>{const t=e.parentElement.lastElementChild;e.checked=!1,t.style.display="block"})),n.disabled=!0;const t=sessionStorage.getItem("subBlocked");t&&"true"===t||y.fire({text:"브라우저/기기 환경당 한 사용자만 알림 설정을 킬 수 있습니다. 만약 본인의 기기/브라우저 환경에서 이 알림이 떴다면 our42vent@gmail.com 으로 문의하세요.",icon:"warning"}),sessionStorage.setItem("subBlocked","true")}i=!1}))}i&&(e.forEach((e=>{e.checked=!0})),n.disabled=!1)}else n.disabled=!0}}(t),e.forEach((e=>e.addEventListener("click",(n=>{const o=e.querySelector(".notification-switch-blocker");if(n.target!==o){const n=e.firstElementChild.checked;t[0].checked=!n,t[1].checked=!n,o.style.display="block",async function(e){const t=document.querySelector("#details-notification");if(e){const e=await Notification.requestPermission();if("granted"!==e){const t=new Error;throw t.permission=e,t}const n=await navigator.serviceWorker.register("/serviceWorker.js",{scope:"/"}),o=await J(n);await d.post("/push",{subscription:o,isFirst:!0}),t.disabled=!1}else{const e=await navigator.serviceWorker.getRegistration(),n=await e.pushManager.getSubscription();await n.unsubscribe(),await d.delete("/push",{data:n}),t.disabled=!0}}(!n).then((()=>{o.style.display="none"})).catch((n=>{const o=e.querySelector(".notification-switch-blocker");t[0].checked=!1,t[1].checked=!1,"denied"===n.permission?o.addEventListener("click",(()=>y.fire({text:"우리42벤트 사이트 알림 설정이 차단되어 있습니다. 브라우저 설정에서 차단을 해제해주세요.",icon:"warning"}))):o.style.display="none",document.querySelector("#details-notification").disabled=!0}))}}))))}():document.querySelectorAll(".notification-wrapper").forEach((e=>{e.style.display="none"}))})();